\documentclass{article}

\usepackage[left=1in, right=1in]{geometry}
\usepackage{amsmath,amssymb}

\title{Weak forms for Bloch eigenproblems}
\author{Connor D. Pierce}
\date{\today}


% Equation numbering
\numberwithin{equation}{section}


% Customizable math macros
\newcommand{\imag}{\iota}
\newcommand{\vect}[1]{\boldsymbol{#1}}
\newcommand{\x}{x}
\newcommand{\vecx}{\vect{\x}}
\newcommand{\wavenum}{\kappa}
\newcommand{\wavevec}{\vect{\wavenum}}
\newcommand{\bloch}{e^{-\imag \wavevec \cdot \vecx}}
\newcommand{\blochcomp}[1]{e^{-\imag \wavenum_{#1} \x_{#1}}}
\newcommand{\kernel}[1]{\tilde{#1}}
\newcommand{\dx}{\,\mathrm{d}x}
\newcommand{\ds}{\,\mathrm{d}s}


\begin{document}
\maketitle
\tableofcontents


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Notation}

In this document, the following notation is observed:
%
\begin{description}
    \item[$\omega$] temporal frequency
    \item[$\wavenum$] wave number (spatial frequency)
    \item[$\imag$] (``iota'') the imaginary unit
    \item[$i,j,k,l,m$] subscripts indicating vector/tensor components
\end{description}
%
Bold symbols indicate vectors, e.g. \(\vecx\) is the position vector with components \(\x_{i}\).


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Problems considered} \label{sec:prob}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Scalar Helmholtz equation} \label{sec:prob.scalar}

Eigenproblem:
%
\begin{align}
    %
    \nabla \cdot \left(
    \boldsymbol{E}(\vecx) \nabla w(\vecx, t)
    \right) =& \rho(\vecx) \ddot{w}(\vecx, t) \nonumber \\
    %
    \left(
    E_{ij}(\vecx) w_{,j}(\vecx, t)
    \right)_{,i} =& \rho(\vecx) \ddot{w}(\vecx, t) \nonumber \\
    %
    w(\vecx, t) =& u(\vecx) e^{-\imag \omega t} \nonumber \\
    %
    \left(
        E_{ij}(\vecx) u_{,j}(\vecx)
    \right)_{,i} e^{-\imag \omega t} =& -\omega^2 \rho(\vecx) u(\vecx) e^{
        -\imag \omega t
    } \nonumber \\
    %
    \left(
        E_{ij}(\vecx) u_{,j}(\vecx)
    \right)_{,i} =& -\omega^2 \rho(\vecx) u(\vecx) \label{eq:prob.scalar}
\end{align}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Elasticity equation} \label{sec:prob.vector}

Eigenproblem:
%
\begin{align}
    \nabla \cdot \left(
        \boldsymbol{E}(\vecx) \nabla_s \vect{w}(\vecx, t)
    \right) =& \rho(\vecx) \ddot{\vect{w}}(\vecx, t) \nonumber \\
    %
    \left(
        E_{ijkl}(\vecx) \frac{1}{2} \left(w_{k,l}(\vecx, t) + w_{l,k}(\vecx, t)\right)
    \right)_{,i} =& \rho(\vecx) \ddot{w}_j(\vecx, t) \nonumber \\
    %
    w_j(\vecx, t) =& u_j(\vecx) e^{-\imag \omega t} \nonumber \\
    %
    \left(
        E_{ijkl}(\vecx) \frac{1}{2} \left(u_{k,l}(\vecx) + u_{l,k}(\vecx)\right)
    \right)_{,i} e^{-\imag \omega t} =& -\omega^2 \rho(\vecx) u_j(\vecx) e^{
        -\imag \omega t
    } \nonumber \\
    %
    \left(
        E_{ijkl}(\vecx) \frac{1}{2}\left(u_{k,l}(\vecx) + u_{l,k}(\vecx)\right)
    \right)_{,i} =& -\omega^2 \rho(\vecx) u_j(\vecx) \label{eq:prob.vector}
\end{align}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Bloch ansatz} \label{sec:prob.bloch-ansatz}

Bloch waves have the form
%
\begin{align}
    u(\vecx) =& \kernel{u}(\vecx) \bloch \, , \label{eq:prob.bloch-ansatz}
\end{align}
%
where \(\kernel{u}(\vecx)\) is a function that is periodic on the unit cell.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Direct ($\wavevec(\omega)$)} \label{sec:direct}

In the direct formulation (see Collet et al., 2011), we prescribe the temporal frequency \(\omega\) and wave direction \(\vect{\phi}\) and compute the wavevector magnitudes as the eigenvalues. The periodic functions \(\kernel{u}(\vecx)\) are the eigenfunctions.

\noindent TODO: write me


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Indirect ($\omega(\wavevec)$), untransformed} \label{sec:indirect}

In the untransformed indirect formulation, we prescribe the wavevector through Floquet-periodic boundary conditions and solve for the temporal frequencies \(\omega\) as eigenvalues. The Floquet-periodic displacement fields \(u(\vecx)\) are the corresponding eigenfunctions.

\noindent TODO: write me


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Indirect ($\omega(\wavevec)$), with Bloch transformation}
\label{sec:it}

In the transformed indirect formulation, the Bloch ansatz is used to transform the equations of motion in terms of the periodic function \(\kernel{u}(\vecx)\). The wavevector \(\wavevec\) is prescribed through additional terms that arise in the strong form of the problem, and the temporal frequency \(\omega\) is solved as the eigenvalue. The periodic functions \(\kernel{u}(\vecx)\) are the corresponding eigenfunctions.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Scalar Helmholtz equation} \label{sec:it.scalar}

\input{it.scalar}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Elasticity equation} \label{sec:it.vector}

%\input{it.vector}


\end{document}